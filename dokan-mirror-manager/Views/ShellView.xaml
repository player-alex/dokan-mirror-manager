<mah:MetroWindow x:Class="DokanMirrorManager.Views.ShellView"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
                 xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
                 xmlns:cal="http://caliburnmicro.com"
                 mc:Ignorable="d"
                 Title="Dokan Mirror Manager"
                 Height="600"
                 Width="900"
                 MinHeight="400"
                 MinWidth="700"
                 WindowStartupLocation="CenterScreen"
                 TitleCharacterCasing="Normal"
                 GlowBrush="{DynamicResource MahApps.Brushes.Accent}"
                 BorderThickness="1"
                 ShowInTaskbar="True"
                 Visibility="Visible"
                 Icon="/cloud.png">

    <mah:MetroWindow.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>
    </mah:MetroWindow.Resources>

    <mah:MetroWindow.IconTemplate>
        <DataTemplate>
            <Image Source="/cloud.png"
                   Width="20"
                   Height="20"
                   Margin="4"
                   RenderOptions.BitmapScalingMode="HighQuality"/>
        </DataTemplate>
    </mah:MetroWindow.IconTemplate>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Mount Items ListView -->
        <ListView Grid.Row="0"
                  ItemsSource="{Binding MountItems}"
                  SelectedItem="{Binding SelectedItem}"
                  BorderThickness="1"
                  BorderBrush="{DynamicResource MahApps.Brushes.Accent}"
                  Margin="0,0,0,10">
            <ListView.View>
                <GridView>
                    <!-- Source Path Column -->
                    <GridViewColumn Header="Source Path" Width="250">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding SourcePath}"
                                          ToolTip="{Binding SourcePath}"
                                          TextTrimming="CharacterEllipsis"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <!-- Destination Drive Column -->
                    <GridViewColumn Header="Drive Letter" Width="120">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <ComboBox ItemsSource="{Binding AvailableDriveLetters}"
                                         SelectedItem="{Binding DestinationLetter, UpdateSourceTrigger=PropertyChanged}"
                                         IsEnabled="{Binding CanEditDestination}"
                                         MinWidth="80"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <!-- Auto Mount Column -->
                    <GridViewColumn Header="Auto Mount" Width="90">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <CheckBox IsChecked="{Binding AutoMount}"
                                         HorizontalAlignment="Center"
                                         IsEnabled="{Binding CanEditDestination}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <!-- Read/Write Column -->
                    <GridViewColumn Header="Read Only" Width="80">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <CheckBox IsChecked="{Binding IsReadOnly}"
                                         HorizontalAlignment="Center"
                                         IsEnabled="{Binding CanEditDestination}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <!-- Status Column -->
                    <GridViewColumn Header="Status" Width="180">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding StatusText}"
                                          ToolTip="{Binding StatusText}"
                                          TextTrimming="CharacterEllipsis"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <!-- Actions Column -->
                    <GridViewColumn Header="Actions" Width="120">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <!-- Mount Button -->
                                    <Button cal:Message.Attach="[Event Click] = [Action Mount($dataContext)]"
                                           IsEnabled="{Binding CanMount}"
                                           ToolTip="Mount"
                                           Style="{DynamicResource MahApps.Styles.Button.Circle}"
                                           Width="32"
                                           Height="32"
                                           Margin="2">
                                        <iconPacks:PackIconMaterial Kind="FolderOpen"
                                                                   Width="16"
                                                                   Height="16"/>
                                    </Button>

                                    <!-- Unmount Button -->
                                    <Button cal:Message.Attach="[Event Click] = [Action Unmount($dataContext)]"
                                           IsEnabled="{Binding CanUnmount}"
                                           ToolTip="Unmount"
                                           Style="{DynamicResource MahApps.Styles.Button.Circle}"
                                           Width="32"
                                           Height="32"
                                           Margin="2">
                                        <iconPacks:PackIconMaterial Kind="FolderRemove"
                                                                   Width="16"
                                                                   Height="16"/>
                                    </Button>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="1"
                    Orientation="Horizontal"
                    HorizontalAlignment="Left"
                    Margin="0,0,0,10">
            <Button cal:Message.Attach="[Event Click] = [Action AddMount]"
                   MinWidth="100"
                   Margin="0,0,10,0"
                   Style="{DynamicResource MahApps.Styles.Button.Square.Accent}">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconMaterial Kind="Plus"
                                               Width="16"
                                               Height="16"
                                               Margin="0,0,5,0"/>
                    <TextBlock Text="Add"/>
                </StackPanel>
            </Button>

            <Button cal:Message.Attach="[Event Click] = [Action RemoveMount]"
                   IsEnabled="{Binding CanRemoveMount}"
                   MinWidth="100"
                   Style="{DynamicResource MahApps.Styles.Button.Square}">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconMaterial Kind="Minus"
                                               Width="16"
                                               Height="16"
                                               Margin="0,0,5,0"/>
                    <TextBlock Text="Remove"/>
                </StackPanel>
            </Button>
        </StackPanel>

        <!-- Status Bar -->
        <Border Grid.Row="2"
                BorderThickness="1"
                BorderBrush="{DynamicResource MahApps.Brushes.Accent}"
                Background="{DynamicResource MahApps.Brushes.ThemeBackground}"
                Padding="10,5">
            <TextBlock Text="{Binding StatusMessage}"
                      FontSize="12"
                      Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"/>
        </Border>
    </Grid>
</mah:MetroWindow>
